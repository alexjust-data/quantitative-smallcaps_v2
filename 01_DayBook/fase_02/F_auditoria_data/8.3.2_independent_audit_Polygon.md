**CÃ³mo usar la auditorÃ­a independiente** paso a paso:

---

# INDEPENDENT DATA AUDIT â€” INSTRUCCIONES CLARAS

**Carpeta de auditorÃ­a independiente:**
ğŸ‘‰ [independent_audit/](independent_audit/)

---

## ğŸ“ CONTENIDO DEL PAQUETE

```
independent_audit/
â”œâ”€â”€ verify_against_reference.py
â”œâ”€â”€ make_report_md.py
â”œâ”€â”€ requirements.txt
â”œâ”€â”€ README.md
â”œâ”€â”€ run_example.ps1
â”œâ”€â”€ vendors/
â”‚   â””â”€â”€ polygon_client.py
â”œâ”€â”€ utils/
â”‚   â””â”€â”€ compare_minute.py
â””â”€â”€ reports/
```

**FunciÃ³n de cada parte:**

| Archivo                       | DescripciÃ³n                                                                           |
| ----------------------------- | ------------------------------------------------------------------------------------- |
| `verify_against_reference.py` | Descarga datos externos (ej. Polygon) y compara con tus barras (minute o DIBâ†’minute). |
| `vendors/polygon_client.py`   | Cliente de API para obtener datos de Polygon.io.                                      |
| `utils/compare_minute.py`     | Calcula diferencias relativas y match-rate entre ambos datasets.                      |
| `make_report_md.py`           | Genera un informe `.md` legible con los resultados.                                   |
| `requirements.txt`            | Dependencias necesarias.                                                              |
| `run_example.ps1`             | Script de ejemplo para PowerShell (Windows).                                          |

---

## âš™ï¸ INSTALACIÃ“N

1. Crea un entorno virtual y activa:

   ```bash
   python -m venv .venv
   . .venv/bin/activate      # En Windows: .venv\Scripts\activate
   ```

2. Instala dependencias:

   ```bash
   pip install -r requirements.txt
   ```

---

## ğŸ”‘ CONFIGURAR CLAVE DE POLYGON

* **Mac / Linux:**

  ```bash
  export POLYGON_API_KEY=TU_API_KEY
  ```
* **Windows PowerShell:**

  ```powershell
  $env:POLYGON_API_KEY="TU_API_KEY"
  ```

---

## â–¶ï¸ CÃ“MO EJECUTAR LA AUDITORÃA

### OPCIÃ“N 1 â€” Comparar tus **minute bars**

```bash
python verify_against_reference.py \
  --symbols AMC,AAPL \
  --dates 2024-05-17 \
  --vendor polygon \
  --our-minute-root "D:/04_TRADING_SMALLCAPS/processed/minute" \
  --out reports/report_polygon_minute.json
```

---

### OPCIÃ“N 2 â€” Comparar tus **Dollar Imbalance Bars** (agregadas a minuto)

```bash
python verify_against_reference.py \
  --symbols AMC \
  --dates 2024-05-17 \
  --vendor polygon \
  --our-dib-root "D:/04_TRADING_SMALLCAPS/processed/bars" \
  --out reports/report_polygon_from_dib.json
```

---

## ğŸ§¾ GENERAR INFORME MARKDOWN

```bash
python make_report_md.py \
  --input reports/report_polygon_minute.json \
  --output reports/INDEPENDENT_DATA_REPORT.md \
  --title "Independent Verification vs Polygon (Minute)"
```

El informe se guardarÃ¡ en:
`reports/INDEPENDENT_DATA_REPORT.md`

---

## ğŸ“Š QUÃ‰ VERIFICA

* Alinea ambos datasets por **minuto (UTC)**.
* Calcula diferencias relativas:

  * Precio (mÃ¡ximo entre Î”open, Î”high, Î”low, Î”close)
  * Volumen
* EvalÃºa si cada barra pasa el test:

  * Precio â‰¤ **0.2 %**
  * Volumen â‰¤ **5 %**

Produce:

* `match_rate` global (porcentaje de coincidencias)
* EstadÃ­sticas medias y percentil 95
* Lista de discrepancias ("breaks") para inspecciÃ³n manual

---

## ğŸ” RESULTADO EJEMPLO

```
Wrote report: reports/report_polygon_minute.json
Overall match rate: 0.9856
```

Luego ejecutas `make_report_md.py` para crear un Markdown legible.

---

## âš–ï¸ QUÃ‰ SIGNIFICA

| Resultado           | InterpretaciÃ³n                                                       |
| ------------------- | -------------------------------------------------------------------- |
| `match_rate â‰¥ 0.95` | Dataset validado â€” coincide estadÃ­sticamente con datos de referencia |
| `match_rate < 0.95` | Revisar diferencias (pueden deberse a filtros del feed o horarios)   |

---

## ğŸ§  NOTAS IMPORTANTES

* Tiempos manejados en **UTC**.
* PequeÃ±as diferencias son normales (por redondeo o filtros de *odd lots*).
* El proceso **no depende** de tu suite anterior: es una **verificaciÃ³n independiente**.
* Puedes extender el sistema para otros vendors (IEX, Tiingo, WRDS-TAQ).

---

